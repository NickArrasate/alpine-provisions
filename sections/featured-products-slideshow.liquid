{%- assign product_1 = all_products[section.settings.product_1] -%}
{%- assign current_variant = product_1.selected_or_first_available_variant -%}
{%- assign featured_image_1 = current_variant.featured_image | default: product_1.featured_image -%}

{%- assign product_2 = all_products[section.settings.product_2] -%}
{%- assign current_variant = product_2.selected_or_first_available_variant -%}
{%- assign featured_image_2 = current_variant.featured_image | default: product_2.featured_image -%}

{%- assign product_3 = all_products[section.settings.product_3] -%}
{%- assign current_variant = product_3.selected_or_first_available_variant -%}
{%- assign featured_image_3 = current_variant.featured_image | default: product_3.featured_image -%}

{%- assign product_4 = all_products[section.settings.product_4] -%}
{%- assign current_variant = product_4.selected_or_first_available_variant -%}
{%- assign featured_image_4 = current_variant.featured_image | default: product_4.featured_image -%}

<div id="featuredProductsCarousel" class="carousel slide carousel-fade featured-products-slider" data-ride="carousel" data-interval="6000">
  <div class="section-title-box">
    <h5>Featured Products</h5>
  </div>
  <ol class="carousel-indicators">
    <li data-target="#featuredProductsCarousel" data-slide-to="0" class="active" style="background-image: url('{{ featured_image_1 | img_url: 'large' }}')"></li>
    <li data-target="#featuredProductsCarousel" data-slide-to="1" style="background-image: url('{{ featured_image_2 | img_url: 'large' }}')"></li>
    <li data-target="#featuredProductsCarousel" data-slide-to="2" style="background-image: url('{{ featured_image_3 | img_url: 'large' }}')"></li>
    <li data-target="#featuredProductsCarousel" data-slide-to="3" style="background-image: url('{{ featured_image_4 | img_url: 'large' }}')"></li>
  </ol>
  <div class="carousel-inner featured-products-inner">
    <div class="carousel-item active featured-products-slide">
      <div class="row">
        <div class="col-md-6 d-flex align-items-center ">
          {% include 'responsive-image' with
            image: featured_image_1,
            max_width: 400,
            max_height: 460
          %}
        </div>
        <div class="col-md-6 featured-products-text-box"  style="background-image: url('{{ section.settings.text_section_background.src | img_url: 'large' }}')">
          {% if section.settings.product_title_1 != blank %}
          <h3>{{ section.settings.product_title_1 }}</h3>
          {% else %}
          <h3>{{ product_1.title }}</h3>
          {% endif %}
          {% if section.settings.product_text_1 != blank %}
          <p>{{ section.settings.product_text_1 }}</p>
          {% endif %}
          {% if section.settings.product_button_link_1 != blank %}
          <a href="{{ section.settings.product_button_link_1 }}" class="btn">
            {{ section.settings.product_button_1 }}
          </a>
          {% endif %}
        </div>
      </div>

    </div>
    <div class="carousel-item  featured-products-slide">
      <div class="row ">
        <div class="col-md-6 d-flex align-items-center">
          {% include 'responsive-image' with
            image: featured_image_2,
            max_width: 400,
            max_height: 460
          %}
        </div>
        <div class="col-md-6 featured-products-text-box"  style="background-image: url('{{ section.settings.text_section_background.src | img_url: 'large' }}')">
          {% if section.settings.product_title_2 != blank %}
          <h3>{{ section.settings.product_title_2 }}</h3>
          {% else %}
          <h3>{{ product_2.title }}</h3>
          {% endif %}
          {% if section.settings.product_text_2 != blank %}
          <p>{{ section.settings.product_text_2 }}</p>
          {% endif %}
          {% if section.settings.product_button_link_2 != blank %}
          <a href="{{ section.settings.product_button_link_2 }}" class="btn">
            {{ section.settings.product_button_2 }}
          </a>
          {% endif %}
        </div>
      </div>

    </div>
    <div class="carousel-item featured-products-slide">
      <div class="row">
        <div class="col-md-6 d-flex align-items-center">
          {% include 'responsive-image' with
            image: featured_image_3,
            max_width: 400,
            max_height: 460
          %}
        </div>
        <div class="col-md-6 featured-products-text-box"  style="background-image: url('{{ section.settings.text_section_background.src | img_url: 'large' }}')">
          {% if section.settings.product_title_3 != blank %}
          <h3>{{ section.settings.product_title_3 }}</h3>
          {% else %}
          <h3>{{ product_3.title }}</h3>
          {% endif %}
          {% if section.settings.product_text_3 != blank %}
          <p>{{ section.settings.product_text_3 }}</p>
          {% endif %}
          {% if section.settings.product_button_link_3 != blank %}
          <a href="{{ section.settings.product_button_link_3 }}" class="btn">
            {{ section.settings.product_button_3 }}
          </a>
          {% endif %}
        </div>
      </div>
    </div>
    <div class="carousel-item featured-products-slide">
    <div class="row">
      <div class="col-md-6 d-flex align-items-center">
        {% include 'responsive-image' with
          image: featured_image_4,
          max_width: 400,
          max_height: 460
        %}
      </div>
      <div class="col-md-6 featured-products-text-box" style="background-image: url('{{ section.settings.text_section_background.src | img_url: 'large' }}')">
        {% if section.settings.product_title_4 != blank %}
        <h3>{{ section.settings.product_title_4 }}</h3>
        {% else %}
        <h3>{{ product_4.title }}</h3>
        {% endif %}
        {% if section.settings.product_text_4 != blank %}
        <p>{{ section.settings.product_text_4 }}</p>
        {% endif %}
        {% if section.settings.product_button_link_4 != blank %}
        <a href="{{ section.settings.product_button_link_4 }}" class="btn">
          {{ section.settings.product_button_4 }}
        </a>
        {% endif %}
      </div>
    </div>
    </div>
  </div>
  <div class="carousel-control-box">
    <a class="carousel-control-prev" href="#featuredProductsCarousel" role="button" data-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#featuredProductsCarousel" role="button" data-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="sr-only">Next</span>
    </a>
  </div>
</div>

{% schema %}
{
  "name": "Featured Products Slider",
  "settings": [
    {
      "type": "product",
      "id": "product_1",
      "label": "Product 1"
    },
    {
      "type": "text",
      "id": "product_title_1",
      "label": "Slider 1 Title"
    },
    {
      "type": "text",
      "id": "product_text_1",
      "label": "Slider 1 Text"
    },
    {
      "type": "text",
      "id": "product_button_1",
      "label": "Slider 1 Button Text"
    },
    {
      "type": "url",
      "id": "product_button_link_1",
      "label": "Slider 1 Button Link"
    },
    {
      "type": "product",
      "id": "product_2",
      "label": "Product 2"
    },
    {
      "type": "text",
      "id": "product_title_2",
      "label": "Slider 2 Title"
    },
    {
      "type": "text",
      "id": "product_text_2",
      "label": "Slider 2 Text"
    },
    {
      "type": "text",
      "id": "product_button_2",
      "label": "Slider 2 Button Text"
    },
    {
      "type": "url",
      "id": "product_button_link_2",
      "label": "Slider 2 Button Link"
    },
    {
      "type": "product",
      "id": "product_3",
      "label": "Product 3"
    },
    {
      "type": "text",
      "id": "product_title_3",
      "label": "Slider 3 Title"
    },
    {
      "type": "text",
      "id": "product_text_3",
      "label": "Slider 3 Text"
    },
    {
      "type": "text",
      "id": "product_button_3",
      "label": "Slider 3 Button Text"
    },
    {
      "type": "url",
      "id": "product_button_link_3",
      "label": "Slider 3 Button Link"
    },
    {
      "type": "product",
      "id": "product_4",
      "label": "Product 4"
    },
    {
      "type": "text",
      "id": "product_title_4",
      "label": "Slider 4 Title"
    },
    {
      "type": "text",
      "id": "product_text_4",
      "label": "Slider 4 Text"
    },
    {
      "type": "text",
      "id": "product_button_4",
      "label": "Slider 4 Button Text"
    },
    {
      "type": "url",
      "id": "product_button_link_4",
      "label": "Slider 4 Button Link"
    },
    {
      "type": "image_picker",
      "id": "text_section_background",
      "label": "Text Section Background Image"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Image alignment (disabled)",
      "default": "left",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Featured Products Slider",
      "category": "Features"
    }
  ]
}
{% endschema %}

<script type="application/ld+json">
{
  "@context": "http://schema.org/",
  "@type": "Product",
  "name": "{{ product.title | escape }}",
  "url": "{{ shop.url }}{{ product.url }}",
  {% if product.featured_image %}
    {% assign image_size = product.featured_image.width | append: 'x' %}
    "image": [
      "https:{{ product.featured_image.src | img_url: image_size }}"
    ],
  {% endif %}
  "description": "{{ product.description | strip_html | escape }}",
  {% if current_variant.sku != blank %}
    "sku": "{{ current_variant.sku }}",
  {% endif %}
  "brand": {
    "@type": "Thing",
    "name": "{{ product.vendor | escape }}"
  },
  {% if product.variants %}
    "offers": [
      {% for variant in product.variants %}
        {
          "@type" : "Offer",
          "availability" : "http://schema.org/{% if product.available %}InStock{% else %}OutOfStock{% endif %}",
          "price" : "{{ variant.price | divided_by: 100.00 }}",
          "priceCurrency" : "{{ shop.currency }}",
          "url" : "{{ shop.url }}{{ variant.url }}",
          "itemOffered" :
          {
              "@type" : "Product",
              {% if variant.image %}
                {% assign variant_image_size = variant.image.width | append: 'x' %}
                "image": "http:{{ variant.image.src | img_url: variant_image_size }}",
              {% endif %}
              {% if variant.title != blank %}
                "name" : "{{ variant.title | escape }}",
              {% endif %}
              {% if variant.sku != blank %}
                "sku": "{{ variant.sku }}",
              {% endif %}
              {% if variant.weight != blank %}
                "weight": {
                  "@type": "QuantitativeValue",
                  {% if variant.weight_unit != blank %}
                    "unitCode": "{{ variant.weight_unit }}",
                  {% endif %}
                  "value": "{{ variant.weight | weight_with_unit: variant.weight_unit }}"
                },
              {% endif %}
              "url": "{{ shop.url }}{{ variant.url }}"
          }
        }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ]
  {% endif %}
}
</script>
